File from Pavel2205 with changes